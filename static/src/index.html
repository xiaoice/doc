<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>My AngularJS App</title>
  <link rel="stylesheet" href="css/lib.css"/>
  <link rel="stylesheet" href="css/app.css"/>
  <script type="text/javascript" src="js/lib.js"></script>
  <script type="text/javascript" src="js/app.js"></script>
</head>
<body class="body-layer index-layer">
    <header class="header-boxer clearfix">
        <a class="header-login" href="index.html">DOC文档分享</a>
        <nav class="header-navbar">
            <a class="navbar-item active" href="index.html"><span class="glyphicon glyphicon-home"></span>首页</a>
            <a class="navbar-item" href="doc.html">规范文档</a>
            <a class="navbar-item" href="lib.html">框架库文档</a>
            <a class="navbar-item" href="plugin.html">插件</a>
            <a class="navbar-item" href="tool.html">工具</a>
        </nav>
    </header>
    <bodyer>
        <div class="body-wrapper">
            <section class="section section1">
                <div class="panel-title">规范文档</div>
                <div class="panel-content content">
                    <p>编码规范</p>
                    <p>前后端数据交互文档</p>
                </div>
            </section>
            <section class="section section2">
                <div class="panel-title">框架库文档</div>
                <div class="panel-content content">
                    <p>jQuery</p>
                    <p>RequireJs</p>
                </div>
            </section>
            <section class="section section3">
                <div class="panel-title">插件</div>
                <div class="panel-content content">
                    <p>jquery.touch.js</p>
                    <p>jquery.drag.js</p>
                </div>
            </section>
            <section class="section section4">
                <div class="panel-title">工具</div>
                <div class="panel-content content">
                    <p>在线执行JS。</p>
                    <p>HTML格式化。</p>
                    <p>JSON格式化。</p>
                </div>
            </section>
        </div>
    </bodyer>
    <aside class="aside">
        <a href="#0" class="item"><span class="dot"></span></a>
        <a href="#1" class="item"><span class="dot"></span></a>
        <a href="#2" class="item"><span class="dot"></span></a>
        <a href="#3" class="item"><span class="dot"></span></a>
    </aside>
</body>
</html>

<script>

    var addEvent = (function(window, undefined) {
        var _eventCompat = function(event) {
            var type = event.type;
            if (type == 'DOMMouseScroll' || type == 'mousewheel') {
                event.delta = (event.wheelDelta) ? event.wheelDelta / 120 : -(event.detail || 0) / 3;
            }
            //alert(event.delta);
            if (event.srcElement && !event.target) {
                event.target = event.srcElement;
            }
            if (!event.preventDefault && event.returnValue !== undefined) {
                event.preventDefault = function() {
                    event.returnValue = false;
                };
            }
            /*
             ......其他一些兼容性处理 */
            return event;
        };
        if (window.addEventListener) {
            return function(el, type, fn, capture) {
                if (type === "mousewheel" && document.mozHidden !== undefined) {
                    type = "DOMMouseScroll";
                }
                el.addEventListener(type, function(event) {
                    fn.call(this, _eventCompat(event));
                }, capture || false);
            }
        } else if (window.attachEvent) {
            return function(el, type, fn, capture) {
                el.attachEvent("on" + type, function(event) {
                    event = event || window.event;
                    fn.call(el, _eventCompat(event));
                });
            }
        }
        return function() {};
    })(window);

    $(function(){
        function init() {
            var index=window.location.hash.replace("#","");
            $(".section").height($(window).height());
            $(".body-wrapper").css("transform","translateY("+$(window).height()*(-index)+"px");
            $(".aside .item").removeClass("active").eq(index).addClass("active");
        }

        addEvent(document, "mousewheel", function(event) {
            var index=$(".aside .active").index(),length=$(".aside .item").size();
            processHandle.process(function(){
                if(event.delta > 0){
                    if(index==0){
                        return;
                    }else{
                        index-=1;
                    }
                }else{
                    if(index>=length-1){
                        return;
                    }else{
                        index+=1;
                    }
                }
                $(".aside .item").removeClass("active").eq(index).addClass("active");
                //$(".body-wrapper").css("transform","translate3d(0px, -"+$(window).height()*(index)+"px, 0px)");
                $(".body-wrapper").addClass("linear").css("transform","translateY("+$(window).height()*(-index)+"px");
                window.location.hash=index;
            });
        });

        init();

        $(document).on("click",".aside .item", function () {
            var index=$(this).index();
            $(".body-wrapper").removeClass("linear").css("transform","translateY("+$(window).height()*(-index)+"px");
            $(this).addClass("active").siblings().removeClass("active");
        });

        $(window).resize(init);
    });
</script>
